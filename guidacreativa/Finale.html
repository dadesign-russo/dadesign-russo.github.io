<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Riassunto finale</title>
    <link href="Style.css" rel="stylesheet" type="text/css">
</head>
<body onload="myFunction()">

<nav class="navbar font-Gilroy">

    <label id="menu-mobile">
        <input type="checkbox">
        <span class="menu"> <span class="hamburger"></span> </span>
        <ul>
            <li> <a class="font-Gilroy" href="Home.html">Home</a> </li>
            <li> <a class="font-Gilroy" href="About.html">About</a> </li>
            <li> <a class="font-Gilroy" href="Start.html">Start</a> </li>
        </ul>
    </label>

    <a class="icon-li-navbar" href="Home.html" >
        <img class="icon-img" src="imgs/LOGO.png" alt="Icona del sito">
    </a>

    <ul class="navbar-list">
        <li class="li-navbar">
            <a href="Home.html">Home</a>
        </li>
        <li class="li-navbar">
            <a href="About.html">About</a>
        </li>
        <li class="li-navbar-start">
            <a href="Start.html">
                <img src="imgs/start.png" alt="Start button">
            </a>
        </li>
    </ul>
</nav>

<div class="Pagina">

    <div class="Slider">

        <a href="Start.html"> <img class="img-slider" src="imgs/1.png" alt="1"> </a>
        <a href="1.1.html"> <img class="img-slider2" src="imgs/1.1.png" alt="1.1"> </a>
        <a href="1.2.html"> <img class="img-slider2" src="imgs/1.2.png" alt="1.2"> </a>
        <a href="2.html"> <img class="img-slider" src="imgs/2.png" alt="2"> </a>
        <a href="2.1.html"> <img class="img-slider2" src="imgs/2.1.png" alt="2.1"> </a>
        <a href="2.2.html"> <img class="img-slider2" src="imgs/2.2.png" alt="1"> </a>
        <a href="3.html"> <img class="img-slider" src="imgs/3.png" alt="1"> </a>
        <a href="3.1.html"> <img class="img-slider2" src="imgs/3.1.png" alt="1"> </a>
        <a href="3.2.html"> <img class="img-slider2" src="imgs/3.2.png" alt="1"> </a>
        <a href="4.html"> <img class="img-slider" src="imgs/4.png" alt="1"> </a>
        <a href="4.1.html"> <img class="img-slider2" src="imgs/4.1.png" alt="1"> </a>
        <a href="4.2.html"> <img class="img-slider2" src="imgs/4.2.png" alt="1"> </a>
        <a href="Finale.html"> <img class="img-slider" src="imgs/F-active.png" alt="1"> </a>

    </div>

    <div class="body-finale">

        <div class="modifica">
            <h3 id="NomeProgetto">Nome Progetto</h3><a href="1.2.html"> <img class="matita" src="imgs/modifica.png"> </a>
        </div>
        <div class="modifica">
            <p class="descrizioni-black">Descrizione</p> <a href="1.2.html"> <img class="matita-piccola" src="imgs/modifica.png"> </a>
        </div>
        <p id="DescrizioneProgetto" class="descrizioni-ap">LSAJDIASBCOASBCUISADVBCBUIDS U UWD IIDUC UWHDJLDAS BUCJBUSDOJC UA SCòAA</p>

        <div class="modifica">
            <h3>La tua moodboard</h3><a href="2.2.html"> <img class="matita" src="imgs/modifica.png"> </a>
        </div>

        <div class="Moodboard-box">
            <div class="drag-area"><output id="immagine1" class="result"></output></div>
            <div class="drag-area"><output id="immagine2" class="result"></output></div>
            <div class="drag-area"><output id="immagine3" class="result"></output></div>
        </div>

        <div class="modifica">
            <h3>Le tue sperimentazioni</h3><a href="3.2.html"> <img class="matita" src="imgs/modifica.png"> </a>
        </div>

        <div class="Moodboard-box">
            <div class="drag-area"><output id="immagine4" class="result"></output></div>
            <div class="drag-area"><output id="immagine5" class="result"></output></div>
            <div class="drag-area"><output id="immagine6" class="result"></output></div>
        </div>

        <div class="modifica">
            <h3>Feedback</h3><a href="4.2.html"> <img class="matita" src="imgs/modifica.png"> </a>
        </div>
    </div>
    <div class="left-align">
        <p id="nome1"class="descrizioni-black"></p>
        <p id="recensione1"class="descrizioni"></p>
        <p id="nome2"class="descrizioni-black"></p>
        <p id="recensione2"class="descrizioni"></p>
        <p id="nome3"class="descrizioni-black"></p>
        <p id="recensione3"class="descrizioni"></p>
    </div>

    <button class="freccia-btn" onclick="deleteFunction()"> <img class="nuovo-progetto-btn" src="imgs/iniziaNuovo.png"></button>
</div>

<script>
    function myFunction(){
    let nomeProgetto = document.getElementById("NomeProgetto");
    let descrizioneProgetto = document.getElementById("DescrizioneProgetto");
    let nome1 = document.getElementById("nome1");
    let nome2 = document.getElementById("nome2");
    let nome3 = document.getElementById("nome3");
    let recensione1 = document.getElementById("recensione1");
    let recensione2 = document.getElementById("recensione2");
    let recensione3 = document.getElementById("recensione3");
    let image1= document.getElementById("immagine1");
    let image2= document.getElementById("immagine2");
    let image3= document.getElementById("immagine3");
    let image4= document.getElementById("immagine4");
    let image5= document.getElementById("immagine5");
    let image6= document.getElementById("immagine6");

        nomeProgetto.innerHTML = localStorage.getItem("title");
        descrizioneProgetto.innerHTML = localStorage.getItem("description");
        nome1.innerHTML = localStorage.getItem("name1");
        nome2.innerHTML = localStorage.getItem("name2");
        nome3.innerHTML = localStorage.getItem("name3");
        recensione1.innerHTML = localStorage.getItem("recensione1");
        recensione2.innerHTML = localStorage.getItem("recensione2");
        recensione3.innerHTML = localStorage.getItem("recensione3");

        const indexedDB =
        window.indexedDB ||
        window.mozIndexedDB ||
        window.webkitIndexedDB ||
        window.msIndexedDB ||
        window.shimIndexedDB;

    if (!indexedDB) {
        console.log("IndexedDB could not be found in this browser.");
    }

    const request = indexedDB.open("dbImages", 1);

    //Potrebbe dare errore se lavori utilizzando la modalità di navigazione in incognito
    request.onerror = function (event) {
        console.error("An error occurred with IndexedDB");
        console.error(event);
    };

    request.onupgradeneeded = function (event) {
        request.result.createObjectStore(event.target.result);
        request.result.createObjectStore("images");
    };

    request.onsuccess = function (event){
        let transaction = request.result.transaction("images","readwrite");
        transaction.objectStore("images").get("image1").onsuccess = function (event) {
            let imgFile = event.target.result;
            console.log("Got image1" + imgFile);
            // Get window.URL object
            let URL = window.URL || window.webkitURL;
            // Create and revoke ObjectURL
            if(imgFile != undefined) {
                let imgURL = URL.createObjectURL(imgFile);
                // Set img src to ObjectURL
                const div = document.createElement("div");
                div.innerHTML = `<img src="${imgURL}" alt="PIPPO1">`;
                image1.innerHTML = div.innerHTML;
                // Revoking ObjectURL
                //URL.revokeObjectURL(imgURL);
            }
        };
        transaction.objectStore("images").get("image1").onerror = function (event) {
            console.log("Non ci sta l'immagine 1");
        };

        transaction.objectStore("images").get("image2").onsuccess = function (event) {
            let imgFile = event.target.result;
            console.log("Got image2" + imgFile);
            // Get window.URL object
            let URL = window.URL || window.webkitURL;
            // Create and revoke ObjectURL
            if(imgFile != undefined) {
                let imgURL = URL.createObjectURL(imgFile);
                // Set img src to ObjectURL
                const div = document.createElement("div");
                div.innerHTML = `<img src="${imgURL}" alt="PIPPO1">`;
                image2.innerHTML = div.innerHTML;
                // Revoking ObjectURL
                //URL.revokeObjectURL(imgURL);
            }
        };
        transaction.objectStore("images").get("image2").onerror = function (event) {
            console.log("Non ci sta l'immagine 2");
        };

        transaction.objectStore("images").get("image3").onsuccess = function (event) {
            let imgFile = event.target.result;
            console.log("Got image3" + imgFile);
            // Get window.URL object
            let URL = window.URL || window.webkitURL;
            // Create and revoke ObjectURL
            if(imgFile != undefined){
            let imgURL = URL.createObjectURL(imgFile);
            // Set img src to ObjectURL
            const div = document.createElement("div");
            div.innerHTML = `<img src="${imgURL}" alt="PIPPO1">`;
            image3.innerHTML = div.innerHTML;
            // Revoking ObjectURL
            //URL.revokeObjectURL(imgURL);
            }
        };
        transaction.objectStore("images").get("image3").onerror = function (event) {
            console.log("Non ci sta l'immagine 3");
        };

        transaction.objectStore("images").get("image4").onsuccess = function (event) {
            let imgFile = event.target.result;
            console.log("Got image4" + imgFile);
            // Get window.URL object
            let URL = window.URL || window.webkitURL;
            // Create and revoke ObjectURL
            if(imgFile != undefined){
            let imgURL = URL.createObjectURL(imgFile);
            // Set img src to ObjectURL
            image4.innerHTML = `<img src="${imgURL}" alt="PIPPO">`;
            // Revoking ObjectURL
            //URL.revokeObjectURL(imgURL);
            }
        };
        transaction.objectStore("images").get("image4").onerror = function (event) {
            console.log("Non ci sta l'immagine 4");
        };

        transaction.objectStore("images").get("image5").onsuccess = function (event) {
            let imgFile = event.target.result;
            console.log("Got image5" + imgFile);
            // Get window.URL object
            let URL = window.URL || window.webkitURL;
            // Create and revoke ObjectURL
            if(imgFile != undefined){
            let imgURL = URL.createObjectURL(imgFile);
            // Set img src to ObjectURL
            image5.innerHTML = `<img src="${imgURL}" alt="PIPPO">`;
            // Revoking ObjectURL
            //URL.revokeObjectURL(imgURL);
            }
        };
        transaction.objectStore("images").get("image5").onerror = function (event) {
            console.log("Non ci sta l'immagine 5");
        };

        transaction.objectStore("images").get("image6").onsuccess = function (event) {
            let imgFile = event.target.result;
            console.log("Got image6" + imgFile);
            // Get window.URL object
            let URL = window.URL || window.webkitURL;
            // Create and revoke ObjectURL
            if(imgFile != undefined) {
                let imgURL = URL.createObjectURL(imgFile);
                // Set img src to ObjectURL
                image6.innerHTML = `<img src="${imgURL}" alt="PIPPO">`;
                // Revoking ObjectURL
                //URL.revokeObjectURL(imgURL);
            }
        };
        transaction.objectStore("images").get("image6").onerror = function (event) {
            console.log("Non ci sta l'immagine 6");
        };
    }
    }

    function deleteFunction(){
        let nomeProgetto = document.getElementById("NomeProgetto");
        let descrizioneProgetto = document.getElementById("DescrizioneProgetto");
        let nome1 = document.getElementById("nome1");
        let nome2 = document.getElementById("nome2");
        let nome3 = document.getElementById("nome3");
        let recensione1 = document.getElementById("recensione1");
        let recensione2 = document.getElementById("recensione2");
        let recensione3 = document.getElementById("recensione3");

        nomeProgetto.innerHTML = localStorage.getItem("title");
        descrizioneProgetto.innerHTML = localStorage.getItem("description");
        nome1.innerHTML = localStorage.getItem("name1");
        nome2.innerHTML = localStorage.getItem("name2");
        nome3.innerHTML = localStorage.getItem("name3");
        recensione1.innerHTML = localStorage.getItem("recensione1");
        recensione2.innerHTML = localStorage.getItem("recensione2");
        recensione3.innerHTML = localStorage.getItem("recensione3");

        localStorage.removeItem("name1");
        localStorage.removeItem("name2");
        localStorage.removeItem("name3");
        localStorage.removeItem("recensione1");
        localStorage.removeItem("recensione2");
        localStorage.removeItem("recensione3");
        localStorage.removeItem("title");
        localStorage.removeItem("description");

        const indexedDB =
            window.indexedDB ||
            window.mozIndexedDB ||
            window.webkitIndexedDB ||
            window.msIndexedDB ||
            window.shimIndexedDB;

        if (!indexedDB) {
            console.log("IndexedDB could not be found in this browser.");
        }

        const request = indexedDB.open("dbImages", 1);

        //Potrebbe dare errore se lavori utilizzando la modalità di navigazione in incognito
        request.onerror = function (event) {
            console.error("An error occurred with IndexedDB");
            console.error(event);
        };

        request.onupgradeneeded = function (event) {
            request.result.createObjectStore(event.target.result);
            request.result.createObjectStore("images");
        };

        request.onsuccess = function (event){
            let transaction = request.result.transaction("images","readwrite");

            transaction.objectStore("images").delete("image1").onsuccess = function () {
                console.log("Immagine 1 ci ha lasciato");
            };

            transaction.objectStore("images").delete("image2").onsuccess = function () {
                console.log("Immagine 2 ci ha lasciato");
            };

            transaction.objectStore("images").delete("image3").onsuccess = function () {
                console.log("Immagine 3 ci ha lasciato");
            };

            transaction.objectStore("images").delete("image4").onsuccess = function () {
                console.log("Immagine 4 ci ha lasciato");
            };

            transaction.objectStore("images").delete("image5").onsuccess = function () {
                console.log("Immagine 5 ci ha lasciato");
            };

            transaction.objectStore("images").delete("image6").onsuccess = function (){
                console.log("Immagine 6 ci ha lasciato")
            };
        }
        location.href = 'Home.html';
    }
</script>


</body>
</html>